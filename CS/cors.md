# CORS 정리

## 1. CORS란?

**CORS (Cross-Origin Resource Sharing)** 는  
브라우저에서 **다른 오리진으로 요청한 리소스를 서버가 허용한 경우에만 읽을 수 있도록 하는 보안 메커니즘**이다.

> Security가 아니라 **Resource Sharing**이 정확한 의미다.

---

## 2. Origin(오리진)이란?

오리진은 아래 3가지가 모두 같아야 동일하다고 판단한다.

- 프로토콜 (http / https)
- 호스트 (example.com)
- 포트 (3000, 8080 등)

### 예시

http://localhost:3000
http://localhost:4000 ❌ (포트 다름)
https://localhost:3000 ❌ (프로토콜 다름)

---

## 3. 브라우저가 "막는다"는 의미

CORS 에러는 요청 자체를 차단하는 것이 아니다.

실제 동작:

1. 브라우저가 서버로 요청을 보냄
2. 서버가 응답을 반환함
3. 브라우저가 **JS에서 응답을 읽지 못하게 차단**

그래서 네트워크 탭에서는 200 OK인데 콘솔에서는 CORS 에러가 발생할 수 있다.

---

## 4. 왜 브라우저는 교차 오리진을 막을까?

### 원인: Same-Origin Policy (SOP)

CORS는 **XSS 방지를 위한 기능이 아니다.**

기본 보안 정책인 **Same-Origin Policy(SOP)** 때문이며,  
다른 사이트의 데이터를 JS가 마음대로 읽지 못하도록 제한하는 정책이다.

### 예시 상황

- 사용자가 은행 사이트에 로그인된 상태
- 악성 사이트 방문
- 해당 사이트에서 은행 API 호출
- CORS가 없다면 응답 데이터를 JS로 읽어서 탈취 가능

즉, **사용자의 인증된 데이터를 보호하기 위한 브라우저 보안 정책**이다.

---

## 5. CORS 허용 방법

서버가 응답 헤더에 다음 값을 추가하면 된다.

Access-Control-Allow-Origin: https://example.com

또는 (개발 환경에서 자주 사용)

Access-Control-Allow-Origin: \*

브라우저는 해당 헤더를 보고:

> "서버가 허용했구나" → JS에서 응답 읽기 허용

---

## 6. 프록시 서버 방식이 동작하는 이유

프록시 서버를 사용하면:

1. 브라우저는 같은 오리진으로 요청
2. 서버가 다른 오리진으로 요청
3. 서버가 응답을 받아 다시 클라이언트로 전달

중요한 점:

- **CORS는 브라우저 보안 정책이다**
- 서버 간 통신에는 CORS 개념이 없다

따라서 프록시 방식으로 우회가 가능하다.

---

## 7. 정리

| 내용       | 설명                                             |
| ---------- | ------------------------------------------------ |
| CORS 의미  | Cross-Origin Resource Sharing                    |
| 막는 주체  | 브라우저                                         |
| 막는 대상  | 다른 오리진 응답을 JS가 읽는 것                  |
| 근본 원인  | Same-Origin Policy                               |
| XSS와 관계 | 직접적인 원인은 아님                             |
| 해결 방법  | 서버에서 `Access-Control-Allow-Origin` 헤더 설정 |
| 우회 방법  | 프록시 서버 사용                                 |

---

## 한 줄 요약

> Same-Origin Policy(SOP)를 안전하게 완화하기 위한 브라우저 보안 메커니즘이다.
